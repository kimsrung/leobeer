function CBall(e){var t,a,i,c,r,_,s,o=!1,n=INIT_BALLMASS_NORMAL,A=0,l=0,L=FRICTION_NORMAL,S=EDGEFRICTION_NORMAL,E=ROTATIONSPEED_NORMAL,g=HORIZ_KICKFORCE_NORMAL,I=VERT_KICKFORCE_NORMAL,C=RESTITUTION_KICKFORCE_NORMAL,O=new CVector2(0,INIT_GRAVITY_NORMAL);this._init=function(e){var o="ball_"+Math.floor(3*Math.random()+1);c=createBitmap(s_oSpriteLibrary.getSprite(o)),c.regX=BALL_SIZE/2,c.regY=BALL_SIZE/2,c.x=CANVAS_WIDTH/2,c.y=CANVAS_HEIGHT/2,r=createBitmap(s_oSpriteLibrary.getSprite("shadow")),r.regX=SHADOW_WIDTH/2,r.regY=SHADOW_HEIGHT/2,r.x=c.x,r.y=CANVAS_HEIGHT-BALL_BOUNCE_YOFFSET,r.alpha=.65,_=createBitmap(s_oSpriteLibrary.getSprite("ball_hit")),_.regX=BALL_SIZE/2,_.regY=BALL_SIZE/2,_.x=CANVAS_WIDTH/2,_.y=CANVAS_HEIGHT/2,_.alpha=0,s_oStage.addChild(r),s_oStage.addChild(c),s_oStage.addChild(_),c.on("mousedown",this.clicked,this),t=new CVector2(c.x,c.y),a=new CVector2(0,0),i=new CVector2(0,0),s=e},this.unload=function(){s_oStage.removeChild(c,r,_),c=void 0},this.update=function(){i.addV(O),this._friction(),a.addV(i),t.addV(a),i._init(0,0),c.x=t.getX(),c.y=t.getY(),l=a.getX(),A+=l,c.rotation=A*E,r.x=c.x,r.scaleX=r.scaleY=c.y/(CANVAS_HEIGHT-BALL_SIZE/2-BALL_BOUNCE_YOFFSET),r.alpha=c.y/(CANVAS_HEIGHT-BALL_SIZE/2-BALL_BOUNCE_YOFFSET),_.x=c.x,_.y=c.y,_.rotation=A*E},this.checkEdges=function(){if(t.getX()<BALL_SIZE/2?(t.set(BALL_SIZE/2,t.getY()),a.set(-(1-S)*a.getX(),a.getY())):t.getX()>CANVAS_WIDTH-BALL_SIZE/2&&(t.set(CANVAS_WIDTH-BALL_SIZE/2,t.getY()),a.set(-(1-S)*a.getX(),a.getY())),t.getY()>CANVAS_HEIGHT-BALL_SIZE/2-BALL_BOUNCE_YOFFSET)return t.set(t.getX(),CANVAS_HEIGHT-BALL_SIZE/2-BALL_BOUNCE_YOFFSET),a.set(a.getX(),-(1-S)*a.getY()),!0},this.applyForce=function(e){var t=new CVector2(e.getX(),e.getY());t.scalarDivision(n),i.addV(t)},this.clicked=function(e){if(s_bClickBall!==!1){DISABLE_SOUND_MOBILE!==!1&&s_bMobile!==!1||createjs.Sound.play("tap"),s.increaseScore(),s.playerAnim(t.getX(),t.getY()),a.set(-C*a.getX(),-C*a.getY());var i=new CVector2(-e.rawX+t.getX(),-1*(e.rawY-(t.getY()-BALL_SIZE/2)));i.normalize();var r=new CVector2(i.getX()*g,i.getY()*I-0);this.applyForce(r),o===!1&&(o=!0,createjs.Tween.get(c).to({scaleX:1.15,scaleY:.85},100,createjs.Ease.cubicIn).call(function(){createjs.Tween.get(c).to({scaleX:1,scaleY:1},100,createjs.Ease.cubicOut).call(function(){})}),createjs.Tween.get(_).to({scaleX:1.15,scaleY:.85,alpha:.4},100,createjs.Ease.cubicIn).call(function(){createjs.Tween.get(_).to({scaleX:1,scaleY:1,alpha:0},100,createjs.Ease.cubicOut).call(function(){o=!1})}))}},this._friction=function(){var e=new CVector2(a.getX(),a.getY());e.scalarProduct(-1),e.normalize(),e.scalarProduct(L),this.applyForce(e)},this._v2Limit=function(e,t){e.length()>=t&&(e.normalize(),e.scalarProduct(t))},this._init(e)}